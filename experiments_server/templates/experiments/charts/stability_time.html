<h3>Stability Time</h3>

<canvas id="stabilityTimeChart"></canvas>

<script>
	const EQUILIBRIUM_AFTER_SECONDS = JSON.parse('{{ experiments | map(attribute="equilibrium_after_seconds") | list | tojson | safe }}');
	const FINAL_HEIGHTS_FOR_STABILITY = JSON.parse('{{ experiments | map(attribute="final_height") | list | tojson | safe }}');

	const points = EQUILIBRIUM_AFTER_SECONDS
		.map((value, index) => ({ x: Number(value), y: Number(FINAL_HEIGHTS_FOR_STABILITY[index]) }))
		.filter((point) => Number.isFinite(point.x) && Number.isFinite(point.y));

	if (points.length > 0) {
		const ctxStabilityTime = document.getElementById('stabilityTimeChart').getContext('2d');

		new Chart(ctxStabilityTime, {
			type: 'scatter',
			data: {
				datasets: [{
					label: 'Final Height vs Equilibrium Time',
					data: points,
					parsing: false,
					pointRadius: 6,
					pointHoverRadius: 7
				}]
			},
			options: {
				...window.chartJsPlugins,
				scales: {
					x: {
						title: { display: true, text: 'Equilibrium Time (s)' }
					},
					y: {
						title: { display: true, text: 'Final Height (m)' }
					}
				}
			}
		});
	}
</script>